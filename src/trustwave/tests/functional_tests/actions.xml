<?xml version="1.0" encoding="UTF-8"?>
<root>
    <assets>
        <asset name="asset1" address="192.168.140.32" user="administrator" pass="finjan123" domain="workgroup" workstation="commander_aka" />
        <asset name="asset2" address="192.168.91.222" user="Administrator" pass="Finjan123" domain="workgroup" workstation="wii_bdalak" />
    </assets>
    <verification_methods>
        <!-- vm_params are expected to be found as atributes of the seesion_item element -->
        <verification_method vm_name="substr_exist" vm_params="substr" />
    <!--<verification_method vm_name="both_substr_exist" vm_params="substr1,substr2" /> -->
        <verification_method vm_name="regex_match" vm_params="regex" />
    <!--<verification_method vm_name="regex_search" vm_params="regex" />-->
        <verification_method vm_name="boolean" vm_params="expected" />
        <verification_method vm_name="do_not_verify" vm_params="" />
    </verification_methods>

    <actions>
        <action name="enumerate"  params="key" />
        <action name="value_exists" params="key,value" />
        <action name="key_exists"  params="key" />
        <action name="query_value"  params="key,value" />
        <action name="get_remote_file_version"  params="param" />
        <action name="get_os"  params="" />
        <action name="close_session"  params="" />
    </actions>


    <sessions>
        <session session_name="test real values" asset_name="asset1"  description="all the tests should pass" >
                <!--<session_item  action="enumerate" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion" verification_method="substr_exist" substr="class_name" />-->
                <!--<session_item  action="enumerate" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion"  verification_method="both_substr_exist" substr1="aaa" substr2="bbb" /> -->
                <session_item  action="enumerate" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AeDebug" verification_method="substr_exist" substr="wtsn3" />
                <session_item  action="enumerate" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AeDebug" verification_method="regex_match" regex="^(.*)wtsn3(.*)$" />
                <!--<session_item  action="enumerate" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion" verification_method="regex_match" regex="^.*SeCEdit.*$" />-->
                <session_item  action="key_exists" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion" verification_method="boolean" expected="true" />
                <session_item  action="value_exists" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AeDebug" value="Debugger" verification_method="boolean" expected="true" />
                <session_item  action="query_value" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AeDebug"  value="Debugger" verification_method="substr_exist" substr="drwtsn32" />
                <session_item  action="get_remote_file_version" param="ADMIN$/winhlp32.exe"  verification_method="regex_match" regex="^5.2.3790.1830$" />
                <session_item  action="get_os"  verification_method="substr_exist" substr="CurrentBuild" />
                <session_item  action="get_os"  verification_method="substr_exist" substr="CurrentBuild" />
                <session_item  action="close_session" verification_method="substr_exist" substr="session closed" />

        </session>

        <session session_name="test fake values" asset_name="asset1"  description="all the tests should fail" >
                <!--<session_item  action="enumerate" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion" verification_method="substr_exist" substr="class_name" />-->
                <!--<session_item  action="enumerate" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion"  verification_method="both_substr_exist" substr1="aaa" substr2="bbb" /> -->
                <session_item  action="enumerate" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Dubi_Gal" verification_method="substr_exist" substr="wtsn3" />
                <session_item  action="enumerate" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Dudi_Goodman" verification_method="regex_match" regex="^(.*)putar(.*)$" />
                <!--<session_item  action="enumerate" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion" verification_method="regex_match" regex="^.*SeCEdit.*$" />-->
                <session_item  action="key_exists" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion" verification_method="boolean" expected="true" />
                <session_item  action="value_exists" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AeDebug" value="Debugger" verification_method="boolean" expected="true" />
                <session_item  action="query_value" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AeDebug"  value="Debugger" verification_method="substr_exist" substr="drwtsn32" />
                <session_item  action="get_remote_file_version" param="ADMIN$/winhlp32.exe"  verification_method="regex_match" regex="^5.2.3790.1830$" />
                <session_item  action="get_os"  verification_method="substr_exist" substr="CurrentBuild" />
                <session_item  action="get_os"  verification_method="substr_exist" substr="CurrentBuild" />
                <session_item  action="close_session" verification_method="substr_exist" substr="session closed" />

        </session>

        <session asset_name="asset2" session_name="test enumerate"   description="aaasssqqqwww" >
            <session_item  action="enumerate" key="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion" verification_method="do_not_verify" />
        </session>-->
    </sessions>
</root>
